% $Header$

\documentclass[aspectratio=169]{beamer}
% \includeonlyframes{current}

\input{preamble}
\input{math}
% \setbeameroption{show notes on second screen}


\draft% Todos appear in red
\usetheme{accacio}
\usecolortheme{green}

\webcast%

\title[Short Title] % (optional, use only with long paper titles)
{
  \todo{
    Complete Title
  }
}

\author[Rafael Accácio Nogueira] % (optional, use only with lots of authors)
{Rafael  Accácio Nogueira \\
\texttt{\{rafael.accacio.nogueira\} at  gmail.com}}

\institute[
% IETR --- CentraleSupélec
] % (optional, but mostly needed)
{
  % \inst{1}%
  % AUT Department \\IETR --- CentraleSupélec \\[10pt]\\\includegraphics[width=1.5cm]{../img/logos/supelec.jpeg}
}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date[
% Conference Short name
] % (optional, should be abbreviation of conference name)
{
Conference Name\\
  \begin{minipage}{.3\textwidth}
    \centering
    % \includegraphics[width=2cm]{logos/logo_IETR.png}
  \end{minipage}
  \begin{minipage}{.3\textwidth}
    \centering
    \vspace{10pt}
    \includegraphics[width=1.5cm]{qrPresentation.png}
    % qrencode https://github.com/Accacio/SysTol-21/raw/main/presentation/presentation.pdf -o ~/git/SysTol21/img/qrPresentation.png
    % \href{https://git.io/JEFGW}{https://git.io/JEFGW}
  \end{minipage}
  \begin{minipage}{.3\textwidth}
    \centering
    \vspace{10pt}
    % \includegraphics[width=2cm]{logos/supelec.jpeg}
  \end{minipage}
}
% - Either use conference name or its abbreviation.
% - Not really informative to the audience, more for people (including
%   yourself) who are reading the slides online

\subject{}

\logo{
  % \includegraphics[width=1.5cm]{logos/supelec.jpeg}
}

% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
\AtBeginSection[]
{
  \begin{frame}<beamer>{Outline}
    \tableofcontents[currentsection,subsectionstyle=show/show/shaded]
  \end{frame}
}

\begin{document}
% From Beamer
% Structuring a talk is a difficult task and the following structure
% may not be suitable. Here are some rules that apply for this
% solution:

% - Exactly two or three sections (other than the summary).
% - At *most* three subsections per section.
% - Talk about 30s to 2min per frame. So there should be between about
%   15 and 30 frames, all told.

% - A conference audience is likely to know very little of what you
%   are going to talk about. So *simplify*!
% - In a 20min talk, getting the main ideas across is hard
%   enough. Leave out details, even if it means being less precise than
%   you think necessary.
% - If you omit details that are vital to the proof/implementation,
%   just say so once. Everybody will be happy with that.

\begin{frame}[plain]
  \titlepage%
  \note{15 minutes !!!!\\}
  \script{Hello, I'm Rafael Accácio and I'm here to present our paper}
\end{frame}

\begin{frame}{Context}
  \centering
\end{frame}

\newlength\fheight
\newlength\fwidth
\setlength\fwidth{.35\textwidth}
\setlength\fheight{.8\fwidth}
\begin{frame}{Quantity Decomposition | Resource Allocation}
  \usebeamercolor{palette primary}
  \centering
  \begin{minipage}{.45\linewidth}
    \begin{figure}
      \centering
      \scalebox{.55}{
        \begin{tikzpicture}[font=\small,thick,node distance=.6cm and 6cm]
          \node[draw,
          rounded rectangle,
          fill=gray!90!black!50,
          alt=<{2}>{fill=bg!90,text=white},
          minimum width=2.5cm,
          minimum height=1cm] (block1) {Start};

          \node[draw,
          trapezium,
          trapezium left angle = 65,
          trapezium right angle = 115,
          trapezium stretches,
          align=center,
          below=of block1,
          fill=bg!10,
          alt=<{3}>{fill=bg!90,text=white},
          minimum width=3.5cm,
          minimum height=1cm
          ] (block7) { Coordinator sends \\$\vec{\theta}_i^{(h)}$};
          \node[draw,
          trapezium,
          trapezium left angle = 65,
          trapezium right angle = 115,
          trapezium stretches,
          align=center,
          fill=bg!10,
          alt=<{4}>{fill=bg!90,text=white},
          below=of block7,
          minimum width=3.5cm,
          minimum height=1cm
          ] (block8) { Agents send \\$\vec{\lambda}_i(\vec{\theta}_{i}^{(h)})$};

          \node[draw,
          trapezium,
          trapezium left angle = 65,
          trapezium right angle = 115,
          trapezium stretches,
          align=center,
          fill=bg!10,
          alt=<{5}>{fill=bg!90,text=white},
          below=of block8,
          minimum width=3.5cm,
          minimum height=1cm
          ] (block9) { Coordinator updates \\allocation};

          \node[draw,
          diamond,
          below=of block9,
          minimum width=2.5cm,
          fill=bg!50,
          alt=<{6}>{fill=bg!90,text=white},
          align=center,
          inner sep=0] (block10) { Negotiation\\ converges?};

          \node[draw,
          rounded rectangle,
          below=of block10,
          fill=gray!90!black!50,
          alt=<{7}>{fill=bg!90,text=white},
          minimum width=2.5cm,
          minimum height=1cm,] (block11) { Apply first control};

          \draw[-latex] (block7) edge (block8)
          (block1) edge (block7)
          (block8) edge (block9)
          (block9) edge (block10);

          \draw[-latex] (block10) -- (block11)
          node[pos=0.4,fill=white,inner sep=0]{Yes};

          \draw[-latex] (block10) -| ($(block7.east) + (1.5cm,0)$)
          node[pos=0.25,fill=white,inner sep=0]{No} -- (block7.east);

        \end{tikzpicture}
      }
    \end{figure}
  \end{minipage}
  \only<7->{\begin{minipage}{.45\linewidth}
    \begin{figure}
      \centering
    \end{figure}
  \end{minipage}}
  \script<1->{In a flowchart for a quantity decomposition based DMPC,}
  \script<3->{the coordinator sends the allocation theta, }
  \script<4->{the agents send the dual variable lambda, }
  \script<5->{the coordinator updates the allocation. }
  \script<6->{If negotiation converges, }
  \script<7->{then the negotiation ends and each agent applies the first element of the control found}
\end{frame}

\begin{frame}{}
  \centering
  \vfill
What if \visible<1->{... }\visible<2>{agents sent a non-agreed $\vec{\lambda}_{i}$?}
  \vfill
  \script<1>{But what if the agents sent a non-agreed lambda?}
\end{frame}

\appendix
\begin{frame}[allowframebreaks]
  % \bibliographystyle{IEEEtran}
  % \bibliography{../article/bibliography}
  \frametitle<presentation>{For Further Reading}

  \begin{thebibliography}{10}

    \beamertemplatebookbibitems
    % Start with overview books.

    \bibitem{item1}
    Author 1, Author 2, \emph{et~al.}
    \newblock \emph{A great book}.\hskip 1em plus 0.5em minus 0.4em\relax
    \newblock Editor, 2014, vol.~69.

    \beamertemplatearticlebibitems
    % Followed by interesting articles. Keep the list short.

    \bibitem{item2}
    Author 1, Author 2,
    \newblock ``An interesting article''
    \newblock \emph{Blablabla 2017}.\hskip 1em plus
    0.5em minus 0.4em\relax Editor, Dec 2042, pp. 6171--6176.

  \end{thebibliography}
  \script{As a recommended reading I give a book about ... . That's all}
\end{frame}

\begin{frame}[plain]
  \closepresentation{https://github.com/Accacio/}{rafael.accacio.nogueira@gmail.com}{Paper Presentation} % (repo, email, email subject)

  \script{If you want to see the simulations of this paper we have a github repository, and if you want to send me an email about this paper or this presentation you can flash the QR code in the right. Thank you!}


\end{frame}



\end{document}
